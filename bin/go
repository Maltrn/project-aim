#!/usr/bin/env bash

b=`tput bold`
nb=`tput sgr0`
SCRIPT_DIR=$(dirname $0)

function echob {
    echo "${b}${1}${nb}"
}

function dockerize-backend {
    ${SCRIPT_DIR}/gradlew clean bootRepackage
    docker build -t meandor/project-aim-backend .
}

function push-backend-image {
    docker push meandor/project-aim-backend
}

function help {
    echo "usage: $0 <task>
task can be:
    help      -- This help message
    check     -- Run all tests
    clean     -- Clean working directory
    cleanIdea -- Remove IntelliJ IDEA files
    idea      -- Generate files for IntelliJ IDEA

              -- Anything else accepted by gradlew
    "
}

if [ "$1" == "help" ]; then
    help
elif [ "$1" == "buildBackend" ]; then
    dockerize-backend
elif [ "$1" == "publishBackend" ]; then
    push-backend-image
else
    ${SCRIPT_DIR}/gradlew $*
fi


